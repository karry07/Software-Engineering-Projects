<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>留言板列表</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap"
          rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="../../assetsimages/x-icon/agricul.png">
    <link rel="stylesheet" href="../../assets/css/relys/animate.css">
    <link rel="stylesheet" href="../../assets/css/relys/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/css/relys/all.min.css">
    <link rel="stylesheet" href="../../assets/css/relys/icofont.min.css">
    <link rel="stylesheet" href="../../assets/css/relys/lightcase.css">
    <link rel="stylesheet" href="../../assets/css/relys/swiper.min.css">
    <link rel="stylesheet" href="../../assets/css/relys/style.css">
    <style type="text/css">
        .name {
            font-weight: bold;
            color: #007BFF;
        }
        .email {
            color: #666;
            font-size: 0.9em;
        }
        .content {
            margin-top: 10px;
            color: #333;
        }
        .container2 {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333333;
            margin-bottom: 20px;
            font-size:30px;
        }
    </style>
</head>
<body>
<div id="app">
    <section class="page-header bg_img padding-tb">
        <div class="overlay"></div>
        <div class="container">
            <div class="page-header-content-area">
                <h4 class="ph-title">留言板列表</h4>
                <ul class="agri-ul">
                    <li><a href="../../index.html">首页</a></li>
                    <li><a class="active">留言板列表</a></li>
                </ul>
            </div>
        </div>
    </section>
    <div class="shop-page padding-tb">
        <div class="container2">
            <h1>留言板</h1>
            <div v-for="(item, i) in list">
                <div :class="['message', { 'border-bottom': i !== list.length - 1 }]">
                    <div class="name">{{ getRandomName() }}</div>
                    <div class="email">{{ item.addtime }}</div>
                    <div class="content">{{ item.content }}</div>
                </div>
            </div>
            <div class="paginations">
                <ul class="agri-ul d-flex flex-wrap justify-content-center" id="paginator"></ul>
            </div>
        </div>
    </div>
</div>
<script src="../../assets/js/relys/jquery.js"></script>
<script src="../../assets/js/relys/fontawesome.min.js"></script>
<script src="../../assets/js/relys/bootstrap.min.js"></script>
<script src="../../assets/js/relys/vue.js"></script>
<script src="../../assets/js/api/api.js"></script>
<script src="../../assets/js/api/tplist.js"></script>
<script src="../../assets/js/relys/utils.js"></script>
<script src="../../assets/js/relys/jq-paginator.min.js"></script>
<div id="script"></div>
</body>
<script type="text/javascript">
    var app = new Vue({
        el: "#app",
        data: {
            list: [],
            page: {
                page: 1,
                limit: 16,
                total: 0
            },
            searchname: '',
            searchval: '',
            names: ['张三', '李四', '王五', '赵六', '孙七', '周八', '吴九', '郑十'],
        },
        methods: {
            // 随机生成匿名信息
            getRandomName() {
                const randomIndex = Math.floor(Math.random() * this.names.length);
                return this.names[randomIndex];
            },
            // 点击跳转
            onPageTap(url) {
                window.location.href = url;
            },
            // 获取列表
            getList(searchname, searchval) {
                return new Promise((resolve) => {
                    goodsList('messages',this.page.page, this.page.limit, searchname, searchval, (res) => {
                        if (res.code == 0) {
                            this.list = res.data.list
                            resolve(res.data)
                        }
                    })
                })
            },
            // 分页
            pageFun(data){
                var that = this
                $('#paginator').jqPaginator({
                    totalPages: data.totalPage,
                    visiblePages: 7,
                    currentPage: that.page.page,
                    prev: '<li class="d-none d-sm-block"><a href="javascript: pageFun()">&lt;</a></li>',
                    next: '<li class="d-none d-sm-block"><a href="javascript: pageFun()">&gt;</a></li>',
                    page: `<li class="d-none d-sm-block"><a href="javascript: pageFun()">{{page}}</a></li>`,
                    onPageChange: function(num, type) {
                        that.page.page = num
                    }
                });
            }
        },
        async created() {
            setTimeout(() => {
                var scripts = [
                    '../../assets/js/relys/wow.min.js',
                    '../../assets/js/relys/swiper.min.js',
                    '../../assets/js/relys/jquery.countdown.min.js',
                    '../../assets/js/relys/jquery.counterup.min.js',
                    '../../assets/js/relys/isotope.pkgd.min.js',
                    '../../assets/js/relys/lightcase.js',
                    '../../assets/js/relys/functions.js',
                ]
                scripts.forEach(ele => {
                    var new_element = document.createElement("script");
                    new_element.setAttribute("type", "text/javascript");
                    new_element.setAttribute("src", ele);
                    $('#script').append(new_element);
                })
            }, 500)
            var search = getParam('search')
            if(search){
                this.searchname = searchname
                this.searchval = search
            }
            var res = await this.getList(this.searchname, this.searchval)
            this.pageFun(res)
        }
    })

    // 分页
    function pageFun(){
        app.getList(false, false)
    }
</script>
</html>